import{r as i,z as k,j as e,U as y,m as a,p as L,C as j,B as T,e as D,q as E}from"./index-D94il1hI.js";import"./api-DRyY-k3C.js";import{p as R}from"./progressService-CBFsFbNs.js";import{c as B}from"./classService-B5TVx5-k.js";import{L as K}from"./loader-68blDsed.js";import{T as d}from"./trending-up-CDV_flEY.js";import{A as u}from"./activity-B4bux6nh.js";import{R as x,L as F,C as o,X as m,Y as h,T as g,a as b,b as P,B as f}from"./LineChart-PZ-PjBgp.js";import{B as N}from"./BarChart-BTHTz7Nd.js";import"./clsx-B-dksMZM.js";const Q=()=>{const[v,n]=i.useState(!0),[t,w]=i.useState(null),[l,C]=i.useState([]),[c,p]=i.useState(null),[$,A]=i.useState(null);i.useEffect(()=>{z()},[]),i.useEffect(()=>{c&&S(c)},[c]);const z=async()=>{try{const s=await B.getClasses();s&&s.length>0?(C(s),p(s[0].id||s[0]._id)):n(!1)}catch(s){console.error("Failed to fetch classes:",s),n(!1)}},S=async s=>{n(!0);try{const r=await R.getEducatorAnalytics(s);w(r)}catch(r){console.error("Failed to fetch analytics:",r),k.error("Failed to load analytics")}finally{n(!1)}};return v?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-purple-50 flex items-center justify-center",children:e.jsx(K,{className:"animate-spin text-purple-600",size:48})}):!l||l.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-purple-50 py-8 px-4 flex items-center justify-center",children:e.jsxs("div",{className:"text-center bg-white p-8 rounded-2xl shadow-lg max-w-md",children:[e.jsx(y,{size:64,className:"mx-auto mb-4 text-purple-200"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"No Classes Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Create a class to start tracking student performance."}),e.jsx("button",{className:"px-6 py-3 bg-purple-600 text-white rounded-xl font-bold hover:bg-purple-700 transition-colors",children:"Create Your First Class"})]})}):t?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-purple-50 py-8 px-4",children:e.jsxs("div",{className:"container mx-auto max-w-7xl",children:[e.jsx(a.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8 flex justify-between items-center",children:e.jsxs("div",{children:[l.length>1?e.jsx("select",{value:c,onChange:s=>p(s.target.value),className:"text-4xl font-bold text-gray-800 bg-transparent border-none focus:ring-0 cursor-pointer mb-2",children:l.map(s=>e.jsx("option",{value:s.id||s._id,children:s.name},s.id||s._id))}):e.jsxs("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:[t.className||l[0]?.name," Analytics"]}),e.jsx("p",{className:"text-gray-600",children:"Track class performance and student progress"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Average Score"}),e.jsxs("p",{className:"text-3xl font-bold text-indigo-600",children:[t.averageScore||0,"%"]})]}),e.jsx("div",{className:"p-3 bg-indigo-100 rounded-xl",children:e.jsx(L,{className:"text-indigo-600",size:24})})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(d,{className:"text-green-600 mr-1",size:16}),e.jsxs("span",{className:"text-green-600 font-semibold",children:["+",t.improvement||0,"%"]}),e.jsx("span",{className:"text-gray-600 ml-1",children:"this week"})]})]}),e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Active Students"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[t.activeStudents||0,"/",t.students||0]})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(y,{className:"text-green-600",size:24})})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.students>0?Math.round((t.activeStudents||0)/t.students*100):0,"% participation"]})]}),e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Avg Completion"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:[t.avgCompletion||0," min"]})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(j,{className:"text-blue-600",size:24})})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Per quiz average"})]}),e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Engagement"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:[t.engagement?.participationRate||0,"%"]})]}),e.jsx("div",{className:"p-3 bg-purple-100 rounded-xl",children:e.jsx(u,{className:"text-purple-600",size:24})})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Participation rate"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[e.jsxs(a.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5},className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx(d,{className:"mr-2 text-indigo-600",size:24}),"Class Performance Trend"]}),t.performanceHistory&&t.performanceHistory.length>0?e.jsx(x,{width:"100%",height:300,children:e.jsxs(F,{data:t.performanceHistory,children:[e.jsx(o,{strokeDasharray:"3 3"}),e.jsx(m,{dataKey:"date"}),e.jsx(h,{domain:[0,100]}),e.jsx(g,{}),e.jsx(b,{}),e.jsx(P,{type:"monotone",dataKey:"avgScore",stroke:"#6366f1",strokeWidth:3,name:"Average Score",dot:{fill:"#6366f1",r:5}})]})}):e.jsx("div",{className:"h-[300px] flex items-center justify-center text-gray-400",children:"Not enough data for trend analysis"})]}),e.jsxs(a.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx(T,{className:"mr-2 text-purple-600",size:24}),"Score Distribution"]}),t.scoreDistribution&&t.scoreDistribution.length>0?e.jsx(x,{width:"100%",height:300,children:e.jsxs(N,{data:t.scoreDistribution,children:[e.jsx(o,{strokeDasharray:"3 3"}),e.jsx(m,{dataKey:"range"}),e.jsx(h,{}),e.jsx(g,{}),e.jsx(b,{}),e.jsx(f,{dataKey:"count",fill:"#8b5cf6",name:"Students"})]})}):e.jsx("div",{className:"h-[300px] flex items-center justify-center text-gray-400",children:"No score data available"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:[e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Weekly Activity"}),t.engagement?.weeklyActivity&&t.engagement.weeklyActivity.length>0?e.jsx(x,{width:"100%",height:250,children:e.jsxs(N,{data:t.engagement.weeklyActivity,children:[e.jsx(o,{strokeDasharray:"3 3"}),e.jsx(m,{dataKey:"day"}),e.jsx(h,{}),e.jsx(g,{}),e.jsx(f,{dataKey:"quizzes",fill:"#3b82f6"})]})}):e.jsx("div",{className:"h-[250px] flex items-center justify-center text-gray-400",children:"No activity data available"})]}),e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},className:"lg:col-span-2 bg-white rounded-2xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Top Students"}),e.jsx("div",{className:"space-y-3",children:t.studentList&&t.studentList.length>0?t.studentList.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>A(s),children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-full flex items-center justify-center text-white font-bold",children:r+1}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.quizzes," quizzes completed"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-indigo-600",children:[s.score,"%"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Last active: ",s.lastActive]})]}),s.trend==="up"&&e.jsx(d,{className:"text-green-600",size:20}),s.trend==="down"&&e.jsx(d,{className:"text-red-600 rotate-180",size:20})]})]},s.id)):e.jsx("p",{className:"text-center text-gray-400 py-8",children:"No student data available"})})]})]}),e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9},className:"bg-white rounded-2xl shadow-lg p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Question Analysis"}),e.jsx("div",{className:"space-y-4",children:t.questionAnalysis&&t.questionAnalysis.length>0?t.questionAnalysis.map(s=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-xl",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-800 mb-1",children:s.text}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsx("span",{className:`px-2 py-1 rounded-full ${s.difficulty==="Easy"?"bg-green-100 text-green-700":s.difficulty==="Medium"?"bg-amber-100 text-amber-700":"bg-red-100 text-red-700"}`,children:s.difficulty}),e.jsxs("span",{className:"text-gray-600",children:["Avg time: ",s.avgTime,"s"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-2xl font-bold ${s.accuracy>=80?"text-green-600":s.accuracy>=60?"text-amber-600":"text-red-600"}`,children:[s.accuracy,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Accuracy"})]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${s.accuracy>=80?"bg-green-500":s.accuracy>=60?"bg-amber-500":"bg-red-500"}`,style:{width:`${s.accuracy}%`}})}),s.accuracy<60&&e.jsxs("div",{className:"mt-2 flex items-start space-x-2 text-sm text-amber-700 bg-amber-50 p-2 rounded",children:[e.jsx(D,{size:16,className:"mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Consider reviewing this topic with students"})]})]},s.questionId)):e.jsx("p",{className:"text-center text-gray-400 py-8",children:"No question analysis data available"})})]}),e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1},className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Engagement Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-6 bg-green-50 rounded-xl",children:[e.jsx(E,{className:"mx-auto mb-3 text-green-600",size:32}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[t.engagement?.participationRate||0,"%"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Participation Rate"})]}),e.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-xl",children:[e.jsx(j,{className:"mx-auto mb-3 text-blue-600",size:32}),e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:[t.engagement?.avgCompletionTime||0," min"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Avg Completion Time"})]}),e.jsxs("div",{className:"text-center p-6 bg-purple-50 rounded-xl",children:[e.jsx(u,{className:"mx-auto mb-3 text-purple-600",size:32}),e.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:[t.engagement?.dropOffRate||0,"%"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Drop-off Rate"})]})]})]})]})}):null};export{Q as default};
