import{b as K,r as l,j as e,U as g,m as b,_ as ee,X as j,W as se,z as r}from"./index-D94il1hI.js";import"./api-DRyY-k3C.js";import{q as te}from"./quizService-Dx9Ufqno.js";import{c as i}from"./classService-B5TVx5-k.js";import{L as q}from"./loader-68blDsed.js";import{P as _,T as ae}from"./trash-2-BP5ptjBv.js";import{B as le}from"./book-open-BMkCaEYn.js";import{C as re}from"./copy-DoTip3Ss.js";import{S as ie}from"./settings-D7lnGAOg.js";import{F as L}from"./file-text-CgTn6Yfy.js";import{S as ne}from"./search-BIwijdH4.js";const fe=()=>{const{user:f}=K(),[y,P]=l.useState([]),[E,N]=l.useState(!0),[I,n]=l.useState(!1),[t,d]=l.useState(null),[o,T]=l.useState([]),[x,v]=l.useState([]),[O,w]=l.useState(!1),[U,u]=l.useState(!1),[B,H]=l.useState([]),[m,C]=l.useState(""),[h,S]=l.useState(""),[z,A]=l.useState(!1),[k,D]=l.useState(""),[F,Q]=l.useState(""),[c,M]=l.useState("");l.useEffect(()=>{p()},[]);const p=async()=>{N(!0);try{const s=await i.getClasses();P(s||[])}catch(s){console.error("Failed to fetch classes:",s)}finally{N(!1)}},V=async s=>{try{const a=await i.getClassAssignments(s);v(a||[])}catch(a){console.error("Failed to fetch assignments",a)}},X=async s=>{s.preventDefault();try{await i.createClass({name:k,subject:F}),r.success("Class created successfully!"),n(!1),D(""),Q(""),p()}catch(a){console.error("Failed to create class:",a),r.error("Failed to create class")}},Y=async s=>{d(s),w(!0);try{const[a,J]=await Promise.all([i.getClassStudents(s.id||s._id),i.getClassAssignments(s.id||s._id)]);T(a||[]),v(J||[])}catch(a){console.error("Failed to fetch class details:",a),r.error("Failed to load class details")}finally{w(!1)}},Z=async s=>{if(s.preventDefault(),!!c)try{await i.inviteStudent(t.id||t._id,c),r.success(`Invitation sent to ${c}`),M("")}catch(a){console.error("Failed to invite student:",a),r.error("Failed to invite student")}},$=async()=>{u(!0),A(!0);try{const s=await te.getUserQuizzes(f._id||f.id);H(s||[])}catch{r.error("Failed to load your quizzes")}finally{A(!1)}},G=async s=>{if(s.preventDefault(),!m||!h){r.error("Please select a quiz and due date");return}try{await i.assignQuiz(t.id||t._id,{quizId:m,dueDate:new Date(h),settings:{attempts:1}}),r.success("Quiz assigned successfully!"),u(!1),C(""),S(""),V(t.id||t._id)}catch(a){console.error("Failed to assign quiz:",a),r.error("Failed to assign quiz")}},R=s=>{navigator.clipboard.writeText(s),r.success("Class code copied!")},W=async s=>{if(window.confirm("Are you sure you want to delete this class? This cannot be undone."))try{await i.deleteClass(s),r.success("Class deleted"),t&&(t.id===s||t._id===s)&&d(null),p()}catch(a){console.error("Failed to delete class:",a),r.error("Failed to delete class")}};return E?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-purple-50 flex items-center justify-center",children:e.jsx(q,{className:"animate-spin text-purple-600",size:48})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-purple-50 py-8 px-4",children:[e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Class Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage your classes and students"})]}),!t&&e.jsxs("button",{onClick:()=>n(!0),className:"bg-purple-600 text-white px-6 py-3 rounded-xl font-bold flex items-center space-x-2 hover:bg-purple-700 transition-colors shadow-lg hover:shadow-xl",children:[e.jsx(_,{size:20}),e.jsx("span",{children:"Create Class"})]}),t&&e.jsx("button",{onClick:()=>d(null),className:"bg-white text-gray-700 px-6 py-3 rounded-xl font-bold flex items-center space-x-2 hover:bg-gray-100 transition-colors border border-gray-200",children:e.jsx("span",{children:"Back to Classes"})})]}),!t&&e.jsx(e.Fragment,{children:y.length===0?e.jsxs("div",{className:"text-center py-20 bg-white rounded-3xl shadow-lg",children:[e.jsx(g,{size:64,className:"mx-auto mb-4 text-gray-300"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"No Classes Yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first class to get started!"}),e.jsx("button",{onClick:()=>n(!0),className:"bg-purple-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-purple-700 transition-colors",children:"Create Class"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map(s=>e.jsxs(b.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},whileHover:{y:-5},className:"bg-white rounded-2xl shadow-lg p-6 cursor-pointer group hover:shadow-xl transition-all border border-gray-100",onClick:()=>Y(s),children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-xl text-purple-600 group-hover:bg-purple-600 group-hover:text-white transition-colors",children:e.jsx(le,{size:24})}),e.jsx("div",{className:"dropdown relative",onClick:a=>a.stopPropagation(),children:e.jsx("button",{className:"text-gray-400 hover:text-gray-600 p-1",children:e.jsx(ee,{size:20})})})]}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:s.name}),e.jsxs("p",{className:"text-gray-500 text-sm mb-4",children:[s.subject," • ",s.studentCount||0," Students"]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsx("div",{className:"flex -space-x-2",children:e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 border-2 border-white flex items-center justify-center text-xs font-bold text-gray-500",children:e.jsx(g,{size:12})})}),e.jsx("span",{className:"text-sm font-semibold text-purple-600 group-hover:underline",children:"View Details →"})]})]},s.id||s._id))})}),t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:t.name}),e.jsxs("p",{className:"text-gray-600 text-lg flex items-center",children:[e.jsx("span",{className:"bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm font-bold mr-3",children:t.subject}),o.length," Students Enrolled"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Class Code"}),e.jsxs("button",{onClick:()=>R(t.code||"XYZ123"),className:"text-2xl font-mono font-bold text-gray-800 flex items-center hover:text-purple-600 transition-colors group",children:[t.code||"XYZ123",e.jsx(re,{size:18,className:"ml-2 opacity-0 group-hover:opacity-100 transition-opacity"})]})]})]}),e.jsxs("div",{className:"flex space-x-4 mt-8",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[e.jsx(ie,{size:18}),e.jsx("span",{children:"Settings"})]}),e.jsxs("button",{onClick:()=>W(t.id||t._id),className:"flex items-center space-x-2 px-4 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors",children:[e.jsx(ae,{size:18}),e.jsx("span",{children:"Delete Class"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center",children:[e.jsx(L,{className:"mr-2 text-purple-600",size:24}),"Active Assignments"]}),e.jsxs("button",{onClick:$,className:"px-4 py-2 bg-purple-100 text-purple-700 rounded-lg font-semibold hover:bg-purple-200 transition-colors flex items-center",children:[e.jsx(_,{size:18,className:"mr-1"})," Assign Quiz"]})]}),x.length===0?e.jsx("div",{className:"text-center py-8 border-2 border-dashed border-gray-100 rounded-xl",children:e.jsx("p",{className:"text-gray-500",children:"No active assignments"})}):e.jsx("div",{className:"space-y-3",children:x.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm text-purple-600",children:e.jsx(L,{size:20})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800",children:s.quiz?.title||"Quiz"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Due: ",new Date(s.dueDate).toLocaleDateString()]})]})]}),e.jsx("span",{className:"text-sm font-semibold text-green-600 bg-green-50 px-3 py-1 rounded-full",children:"Active"})]},a))})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Students"}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search students...",className:"pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),O?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(q,{className:"animate-spin text-purple-600",size:32})}):o.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200",children:[e.jsx(g,{size:48,className:"mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No students enrolled yet"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Invite students to join utilizing the class code"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"text-left text-gray-500 text-sm border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"pb-3 font-medium pl-4",children:"Name"}),e.jsx("th",{className:"pb-3 font-medium",children:"Progress"}),e.jsx("th",{className:"pb-3 font-medium",children:"Last Active"}),e.jsx("th",{className:"pb-3 font-medium text-right pr-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:o.map(s=>e.jsxs("tr",{className:"group hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-4 pl-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-sm",children:s.name?.charAt(0)||"S"}),e.jsx("span",{className:"font-semibold text-gray-800",children:s.name})]})}),e.jsxs("td",{className:"py-4",children:[e.jsx("div",{className:"w-24 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500",style:{width:`${s.progress||0}%`}})}),e.jsxs("span",{className:"text-xs text-gray-500 mt-1 block",children:[s.progress||0,"% Complete"]})]}),e.jsx("td",{className:"py-4 text-sm text-gray-600",children:s.lastActive||"Never"}),e.jsx("td",{className:"py-4 text-right pr-4",children:e.jsx("button",{className:"text-gray-400 hover:text-red-500 transition-colors p-1",children:e.jsx(j,{size:18})})})]},s.id))})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx(se,{size:20,className:"mr-2 text-purple-600"}),"Invite Student"]}),e.jsxs("form",{onSubmit:Z,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",required:!0,value:c,onChange:s=>M(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"student@example.com"})]}),e.jsx("button",{type:"submit",className:"w-full bg-purple-600 text-white py-2 rounded-xl font-bold hover:bg-purple-700 transition-colors",children:"Send Invitation"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl shadow-lg p-6 text-white",children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Quick Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white/10 rounded-lg p-3",children:[e.jsx("span",{children:"Quizzes Assigned"}),e.jsx("span",{className:"font-bold",children:x.length})]}),e.jsxs("div",{className:"flex justify-between items-center bg-white/10 rounded-lg p-3",children:[e.jsx("span",{children:"Students"}),e.jsx("span",{className:"font-bold",children:o.length})]}),e.jsxs("div",{className:"flex justify-between items-center bg-white/10 rounded-lg p-3",children:[e.jsx("span",{children:"Top Performer"}),e.jsx("span",{className:"font-bold",children:"--"})]})]})]})]})]})]})]}),I&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs(b.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Create New Class"}),e.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(j,{size:24})})]})}),e.jsxs("form",{onSubmit:X,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class Name"}),e.jsx("input",{type:"text",required:!0,value:k,onChange:s=>D(s.target.value),placeholder:"e.g. Grade 10 Mathematics",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),e.jsxs("select",{required:!0,value:F,onChange:s=>Q(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{value:"",children:"Select a Subject"}),e.jsx("option",{value:"Mathematics",children:"Mathematics"}),e.jsx("option",{value:"Science",children:"Science"}),e.jsx("option",{value:"History",children:"History"}),e.jsx("option",{value:"Literature",children:"Literature"}),e.jsx("option",{value:"Computer Science",children:"Computer Science"}),e.jsx("option",{value:"Art",children:"Art"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",className:"w-full bg-purple-600 text-white py-3 rounded-xl font-bold hover:bg-purple-700 transition-colors shadow-lg shadow-purple-200",children:"Create Class"})})]})]})}),U&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs(b.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Assign Quiz"}),e.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(j,{size:24})})]})}),e.jsxs("form",{onSubmit:G,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Quiz"}),z?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading your quizzes..."}):e.jsxs("select",{required:!0,value:m,onChange:s=>C(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{value:"",children:"Choose a quiz..."}),B.map(s=>e.jsx("option",{value:s._id||s.id,children:s.title},s._id||s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),e.jsx("input",{type:"datetime-local",required:!0,value:h,onChange:s=>S(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",disabled:z,className:"w-full bg-purple-600 text-white py-3 rounded-xl font-bold hover:bg-purple-700 transition-colors shadow-lg shadow-purple-200 disabled:opacity-50",children:"Assign to Class"})})]})]})})]})};export{fe as default};
