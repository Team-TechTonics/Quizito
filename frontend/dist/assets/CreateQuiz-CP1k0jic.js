import{c as F,r as p,j as e,H as Y,e as oe,f as ee,Z as _,z as n,R as le,m as M,A as J,C as Z,g as ne,X as ce,b as de,h as ue,i as te,k as xe}from"./index-D94il1hI.js";import"./api-DRyY-k3C.js";import{q as I}from"./quizService-Dx9Ufqno.js";import{T as se}from"./trending-up-CDV_flEY.js";import{T as me,P as G}from"./trash-2-BP5ptjBv.js";import{S as pe}from"./save-CdSKa8pG.js";import{F as re}from"./file-text-CgTn6Yfy.js";import{C as ge}from"./copy-DoTip3Ss.js";const he=F("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const be=F("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const K=F("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);const fe=F("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);const X=F("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);const ye=F("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);const W=F("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),je=({onGenerate:R,loading:j,setLoading:h})=>{const[i,v]=p.useState(""),[c,C]=p.useState(10),[f,l]=p.useState("medium"),[m,N]=p.useState(!1),Q=[{id:"easy",label:"Easy",color:"bg-green-100 text-green-800"},{id:"medium",label:"Medium",color:"bg-yellow-100 text-yellow-800"},{id:"hard",label:"Hard",color:"bg-red-100 text-red-800"}],S=["World History","Computer Science","Biology","Pop Culture","Sports","Geography","Mathematics","Literature"],q=()=>{const o=[];for(let x=1;x<=c;x++){const b=[{text:`Correct Answer for Q${x}`,isCorrect:!0},{text:"Wrong Option 1",isCorrect:!1},{text:"Wrong Option 2",isCorrect:!1},{text:"Wrong Option 3",isCorrect:!1}];b.sort(()=>Math.random()-.5);const k=b.find(T=>T.isCorrect);o.push({question:`Sample Question ${x}: What is a key fact about ${i}?`,type:"multiple-choice",options:b,correctAnswer:k.text,explanation:`This is the explanation for question ${x} regarding ${i}.`,difficulty:f,points:100,timeLimit:30,tags:[i.toLowerCase().replace(/\s+/g,"-"),"fallback"]})}return{title:`Quiz: ${i}`,description:`Auto-generated fallback quiz about ${i}`,category:i,difficulty:f,questions:o,aiGenerated:!1,fallback:!0}},A=async o=>{if(o.preventDefault(),!i.trim()){n.error("Please enter a topic");return}h(!0);try{console.log("Generating quiz for topic:",i);let x;if(m)n.loading("Generating fallback questions...",{id:"ai-generate"}),await new Promise(b=>setTimeout(b,800)),x=q(),n.success("Fallback questions generated!",{id:"ai-generate"});else try{x=await I.generateAIQuiz(i,{numQuestions:c,difficulty:f,category:i,includeExplanations:!0}),n.success("AI quiz generated successfully!")}catch(b){console.warn("AI service failed, asking for fallback:",b);const k=b.message||"AI service unavailable";if(window.confirm(`AI Error: ${k}

Would you like to generate a fallback quiz instead?`))N(!0),x=q();else throw new Error("AI generation cancelled")}R&&x&&R(i,c,f,{quiz:x,model:x.aiModel||"fallback",fallback:!!x.fallback})}catch(x){console.error("Quiz Generation Error:",x),x.message!=="AI generation cancelled"&&n.error(x.message||"Failed to generate quiz")}finally{h(!1)}},w=o=>{v(o)};return e.jsxs("form",{onSubmit:A,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"What topic would you like to quiz about?"}),e.jsx("input",{type:"text",value:i,onChange:o=>v(o.target.value),placeholder:"e.g., Renaissance Art, Quantum Physics, JavaScript Basics",className:"input-field text-lg py-4",required:!0,disabled:j}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Quick suggestions:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:S.map(o=>e.jsx("button",{type:"button",onClick:()=>w(o),disabled:j,className:"px-3 py-2 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",children:o},o))})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2 text-sm font-semibold text-gray-700 mb-4",children:[e.jsx(Y,{size:16}),e.jsx("span",{children:"Number of Questions"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"range",min:"5",max:"20",value:c,onChange:o=>C(parseInt(o.target.value)),disabled:j,className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer disabled:opacity-50"}),e.jsx("div",{className:"text-2xl font-bold text-primary-600 min-w-[60px]",children:c})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2 text-sm font-semibold text-gray-700 mb-4",children:[e.jsx(se,{size:16}),e.jsx("span",{children:"Difficulty Level"})]}),e.jsx("div",{className:"flex gap-2",children:Q.map(o=>e.jsx("button",{type:"button",onClick:()=>l(o.id),disabled:j,className:`flex-1 py-3 rounded-lg font-medium transition-all disabled:opacity-50 ${f===o.id?`${o.color} ring-2 ring-offset-2 ring-opacity-50`:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:o.label},o.id))})]})]}),e.jsx("div",{className:"p-4 bg-yellow-50 rounded-xl border border-yellow-200",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(oe,{className:"text-yellow-600 flex-shrink-0 mt-0.5",size:20}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"Generation Mode"}),e.jsxs("div",{className:"flex gap-4 mb-3",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:!m,onChange:()=>N(!1),disabled:j,className:"text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-gray-700",children:"Try AI First"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:m,onChange:()=>N(!0),disabled:j,className:"text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-gray-700",children:"Use Fallback Mode"})]})]}),e.jsx("p",{className:"text-sm text-yellow-700",children:m?"Generates template questions locally. Useful for testing or if API is unavailable.":"Attempts to use OpenAI/DeepSeek to generate custom questions. Falls back if API works."})]})]})}),e.jsxs("div",{className:"pt-8 border-t border-gray-100",children:[e.jsx("button",{type:"submit",disabled:j||!i.trim(),className:`w-full text-lg py-4 relative overflow-hidden group disabled:opacity-50 disabled:cursor-not-allowed rounded-xl transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-1 ${m?"bg-gradient-to-r from-gray-700 to-gray-800 text-white":"bg-gradient-to-r from-primary-600 to-accent-600 text-white"}`,children:e.jsx("div",{className:"flex items-center justify-center space-x-3",children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Generating Quiz..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"group-hover:scale-110 transition-transform"}),e.jsx("span",{children:m?"Generate Fallback Quiz":"Generate Quiz with AI"}),e.jsx(_,{className:"group-hover:scale-110 transition-transform"})]})})}),e.jsx("p",{className:"text-center text-sm text-gray-500 mt-4",children:m?`Will generate ${c} ${f} sample questions about "${i}"`:`AI will generate ${c} ${f} questions about "${i}"`})]})]})},ve=({onCreate:R,loading:j,initialData:h})=>{const[i,v]=p.useState(h||{title:"",description:"",category:"",difficulty:"medium",questions:[]});le.useEffect(()=>{h&&v(t=>({...t,...h,questions:h.questions||[]}))},[h]);const[c,C]=p.useState(null),f={question:"",type:"multiple-choice",options:[{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1}],correctAnswer:"",points:100,timeLimit:30,difficulty:"medium",explanation:""},[l,m]=p.useState(f),[N,Q]=p.useState(!0),S=["General Knowledge","Science","Technology","History","Geography","Sports","Entertainment","Mathematics","Literature","Art","Music","Other"],q=[{id:"easy",label:"Easy",color:"bg-green-100 text-green-700 border-green-200"},{id:"medium",label:"Medium",color:"bg-yellow-100 text-yellow-700 border-yellow-200"},{id:"hard",label:"Hard",color:"bg-red-100 text-red-700 border-red-200"}],A=[{id:"multiple-choice",label:"Multiple Choice",icon:"ðŸ“",desc:"Select one correct answer"},{id:"true-false",label:"True/False",icon:"ðŸ”˜",desc:"Binary choice"},{id:"short-answer",label:"Short Answer",icon:"âœï¸",desc:"Type the exact answer"}],w=(t,a)=>{v(s=>({...s,[t]:a}))},o=(t,a)=>{m(s=>({...s,[t]:a}))},x=(t,a,s)=>{const r=[...l.options];r[t]={...r[t],[a]:s},m(d=>({...d,options:r}))},b=t=>{const a=l.options.map((s,r)=>({...s,isCorrect:r===t}));m(s=>({...s,options:a,correctAnswer:l.options[t]?.text||""}))},k=()=>{if(l.options.length>=6){n.error("Maximum 6 options allowed");return}m(t=>({...t,options:[...t.options,{text:"",isCorrect:!1}]}))},T=t=>{if(l.options.length<=2){n.error("Minimum 2 options required");return}const a=l.options.filter((s,r)=>r!==t);m(s=>({...s,options:a}))},P=()=>{if(!l.question.trim())return n.error("Please enter a question text"),!1;if(l.type==="multiple-choice"){if(l.options.some(t=>!t.text.trim()))return n.error("All options must have text"),!1;if(!l.options.some(t=>t.isCorrect))return n.error("Please mark one option as correct"),!1}return!0},U=()=>{if(!P())return;const t={...l};if(t.type,c!==null){const a=[...i.questions];a[c]=t,v(s=>({...s,questions:a})),C(null),n.success("Question updated!")}else v(a=>({...a,questions:[...a.questions,t]})),n.success("Question added!");m({...f,timeLimit:l.timeLimit,points:l.points,difficulty:l.difficulty}),Q(!0)},L=t=>{const a=i.questions[t];m({...a}),C(t),Q(!0),document.getElementById("question-editor")?.scrollIntoView({behavior:"smooth"})},H=t=>{if(!window.confirm("Delete this question?"))return;const a=i.questions.filter((s,r)=>r!==t);v(s=>({...s,questions:a})),n.success("Question deleted")},B=()=>{if(!i.title.trim()){n.error("Please enter a quiz title"),document.getElementById("quiz-title")?.focus();return}if(i.questions.length===0){n.error("Please add at least one question");return}R(i)};return e.jsxs("div",{className:"space-y-8 max-w-4xl mx-auto",children:[e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl p-8 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6 pb-4 border-b border-gray-100",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(ye,{size:24,className:"text-purple-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Quiz Details"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:["Quiz Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"quiz-title",type:"text",value:i.title,onChange:t=>w("title",t.target.value),placeholder:"e.g. Advanced Mathematics Final",className:"w-full px-4 py-3 text-lg font-medium border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all placeholder:font-normal",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:i.description,onChange:t=>w("description",t.target.value),placeholder:"What is this quiz about?",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all min-h-[100px] resize-y"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Category"}),e.jsxs("select",{value:i.category,onChange:t=>w("category",t.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all bg-white",children:[e.jsx("option",{value:"",children:"Select a category..."}),S.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Overall Difficulty"}),e.jsx("div",{className:"flex bg-gray-100 p-1 rounded-xl",children:q.map(t=>e.jsx("button",{type:"button",onClick:()=>w("difficulty",t.id),className:`flex-1 py-2 text-sm font-bold rounded-lg transition-all ${i.difficulty===t.id?"bg-white text-gray-800 shadow-sm scale-100":"text-gray-500 hover:text-gray-700"}`,children:t.label},t.id))})]})]})]}),e.jsx(J,{children:i.questions.length>0&&e.jsxs(M.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-700 flex items-center gap-2",children:[e.jsx(Y,{className:"text-purple-500",size:20}),"Questions Added (",i.questions.length,")"]}),e.jsxs("div",{className:"text-sm font-medium text-gray-500 bg-gray-100 px-3 py-1 rounded-full",children:["Total Points: ",i.questions.reduce((t,a)=>t+(a.points||0),0)]})]}),e.jsx("div",{className:"grid gap-4",children:i.questions.map((t,a)=>e.jsx(M.div,{layout:!0,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,scale:.95},className:`bg-white p-5 rounded-xl border-l-4 shadow-sm hover:shadow-md transition-all group ${c===a?"border-purple-500 ring-2 ring-purple-100":"border-gray-300"}`,children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:"font-bold text-gray-400",children:["#",a+1]}),e.jsx("span",{className:"text-xs font-semibold px-2 py-0.5 bg-gray-100 text-gray-600 rounded uppercase tracking-wide",children:t.type.replace("-"," ")}),t.timeLimit&&e.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(Z,{size:10})," ",t.timeLimit,"s"]})]}),e.jsx("h4",{className:"font-semibold text-gray-800 line-clamp-2",children:t.question})]}),e.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>L(a),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(X,{size:16})}),e.jsx("button",{onClick:()=>H(a),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(me,{size:16})})]})]})},a))})]})}),e.jsx(J,{children:N&&e.jsxs(M.div,{layout:!0,id:"question-editor",initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},className:"bg-white rounded-2xl shadow-lg border-2 border-purple-100 overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 px-8 py-4 border-b border-purple-100 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-bold text-purple-900 flex items-center gap-2",children:[c!==null?e.jsx(X,{size:18}):e.jsx(G,{size:18}),c!==null?"Edit Question":"Add New Question"]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>{C(null),m(f)},className:"text-xs font-semibold text-purple-700 hover:text-purple-900 cursor-pointer",children:"Clear Form"})})]}),e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx("div",{children:e.jsx("textarea",{value:l.question,onChange:t=>o("question",t.target.value),placeholder:"Type your question here...",className:"w-full px-5 py-4 text-lg border-2 border-gray-100 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all min-h-[140px] resize-y placeholder:text-gray-300"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:A.map(t=>e.jsxs("button",{type:"button",onClick:()=>o("type",t.id),className:`p-4 rounded-xl border-2 text-left transition-all ${l.type===t.id?"border-purple-500 bg-purple-50 ring-1 ring-purple-500":"border-gray-100 hover:border-gray-300 hover:bg-gray-50"}`,children:[e.jsx("div",{className:"text-2xl mb-2",children:t.icon}),e.jsx("div",{className:"font-bold text-gray-800 text-sm",children:t.label}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:t.desc})]},t.id))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 p-4 bg-gray-50 rounded-xl border border-gray-100",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Points"}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"number",min:"0",step:"10",value:l.points,onChange:t=>o("points",parseInt(t.target.value)||0),className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Time (Sec)"}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("select",{value:l.timeLimit,onChange:t=>o("timeLimit",parseInt(t.target.value)),className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none bg-white appearance-none",children:[10,20,30,45,60,90,120].map(t=>e.jsxs("option",{value:t,children:[t," seconds"]},t))})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Difficulty"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"text-gray-400 absolute left-3 top-1/2 -translate-y-1/2",size:16}),e.jsx("select",{value:l.difficulty,onChange:t=>o("difficulty",t.target.value),className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none bg-white appearance-none",children:q.map(t=>e.jsx("option",{value:t.id,children:t.label},t.id))})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[l.type==="multiple-choice"&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"font-bold text-gray-700 mb-2",children:"Answer Options"}),e.jsx("div",{className:"grid gap-3",children:l.options.map((t,a)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-white cursor-pointer transition-colors shadow-sm ${t.isCorrect?"bg-green-500 ring-2 ring-green-200":"bg-gray-300 hover:bg-gray-400"}`,onClick:()=>b(a),title:"Click to mark as correct",children:t.isCorrect?e.jsx(he,{size:16}):String.fromCharCode(65+a)}),e.jsx("input",{type:"text",value:t.text,onChange:s=>x(a,"text",s.target.value),placeholder:`Option ${String.fromCharCode(65+a)}`,className:`flex-1 px-4 py-3 rounded-xl border-2 transition-all ${t.isCorrect?"border-green-500 bg-green-50":"border-gray-200 focus:border-purple-500"}`}),e.jsx("button",{onClick:()=>T(a),className:"p-2 text-gray-400 hover:text-red-500 transition-colors",children:e.jsx(ce,{size:20})})]},a))}),e.jsxs("button",{onClick:k,className:"mt-2 text-sm font-bold text-purple-600 hover:text-purple-700 flex items-center gap-1",children:[e.jsx(G,{size:16})," Add Option"]})]}),l.type==="true-false"&&e.jsx("div",{className:"grid grid-cols-2 gap-4",children:["True","False"].map(t=>e.jsx("button",{onClick:()=>{m(a=>({...a,correctAnswer:t,options:[{text:"True",isCorrect:t==="True"},{text:"False",isCorrect:t==="False"}]}))},className:`p-6 rounded-xl border-2 font-bold text-xl transition-all ${l.correctAnswer===t?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-gray-300 text-gray-600"}`,children:t},t))}),l.type==="short-answer"&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-700 mb-2",children:"Correct Answer (Exact Match)"}),e.jsx("input",{type:"text",value:l.correctAnswer,onChange:t=>o("correctAnswer",t.target.value),placeholder:"Type the correct answer...",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-purple-500 outline-none font-bold text-gray-800"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-gray-700 mb-2",children:[e.jsx(be,{size:16,className:"text-blue-500"}),"Explanation (Shown after answering)"]}),e.jsx("textarea",{value:l.explanation||"",onChange:t=>o("explanation",t.target.value),placeholder:"Explain why the answer is correct...",className:"w-full px-4 py-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all min-h-[80px]"})]}),e.jsxs("div",{className:"flex gap-4 pt-4 border-t border-gray-100",children:[e.jsxs("button",{onClick:U,className:"flex-1 bg-purple-600 text-white py-4 rounded-xl font-bold hover:bg-purple-700 transition-colors shadow-lg shadow-purple-200 flex items-center justify-center gap-2",children:[c!==null?e.jsx(pe,{size:20}):e.jsx(G,{size:20}),c!==null?"Update Question":"Add Question"]}),c!==null&&e.jsx("button",{onClick:()=>{C(null),m(f)},className:"px-6 py-4 bg-gray-100 text-gray-600 font-bold rounded-xl hover:bg-gray-200",children:"Cancel"})]})]})]})}),!N&&e.jsxs("button",{onClick:()=>Q(!0),className:"w-full py-4 border-2 border-dashed border-gray-300 rounded-xl text-gray-500 font-bold hover:border-purple-500 hover:text-purple-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx(G,{size:24})," Add Another Question"]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 shadow-lg z-40",children:e.jsxs("div",{className:"container mx-auto max-w-4xl flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Total Questions"}),e.jsx("div",{className:"font-bold text-xl text-gray-800",children:i.questions.length})]}),e.jsx("button",{onClick:B,disabled:j||i.questions.length===0,className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-8 py-3 rounded-xl font-bold hover:shadow-lg hover:scale-105 transition-all disabled:opacity-50 disabled:scale-100 disabled:shadow-none",children:j?"Creating Quiz...":"Create & Host Quiz ðŸš€"})]})}),e.jsx("div",{className:"h-24"})," "]})},Ne=[{id:"pop-quiz",title:"Pop Quiz",description:"Quick check-in with random questions.",icon:_,color:"text-yellow-500 bg-yellow-50",settings:{timeLimit:300,questionTime:30,randomizeQuestions:!0,randomizeOptions:!0,difficulty:"medium",numQuestions:5}},{id:"final-exam",title:"Final Exam",description:"Comprehensive assessment mode.",icon:re,color:"text-red-500 bg-red-50",settings:{timeLimit:3600,questionTime:0,randomizeQuestions:!0,showResults:!1,difficulty:"hard",numQuestions:50}},{id:"vocab-check",title:"Vocabulary Check",description:"Fast-paced definition matching.",icon:te,color:"text-purple-500 bg-purple-50",settings:{timeLimit:600,questionTime:15,randomizeQuestions:!0,difficulty:"easy",numQuestions:20}}],Te=()=>{const{user:R}=de(),j=ue(),[h,i]=p.useState("templates"),[v,c]=p.useState(!1),[C,f]=p.useState(0),[l,m]=p.useState(null),[N,Q]=p.useState(null),[S,q]=p.useState(!1),[A,w]=p.useState(null),[o,x]=p.useState(0),b=p.useRef(null),k=p.useRef([]),T=p.useRef(null),P=async s=>{c(!0);try{console.log("Creating quiz with data title:",s.title);const r=await I.createQuiz(s);console.log("Quiz created successfully:",r._id||r.id);const d={quizId:r._id||r.id,name:r.title,description:r.description||"Join this quiz session!",settings:{maxPlayers:100,questionTime:30,showLeaderboard:!0,showCorrectAnswers:!0,allowLateJoin:!0,requireApproval:!1,privateMode:!1,...s.settings}};console.log("Creating session for quiz:",r._id||r.id);const g=await I.createSession(d),u=g.roomCode;console.log("Session created successfully. Room code:",u);const $=window.location.origin,z={playerLink:`${$}/join/${u}`,hostDashboard:`${$}/host/${u}`,embedCode:`<iframe src="${$}/embed/${u}" width="800" height="600"></iframe>`};return localStorage.setItem("currentHostSession",JSON.stringify({roomCode:u,sessionId:g._id||g.id,quizId:r._id||r.id,quizTitle:r.title,joinLinks:z})),n.success(e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(xe,{size:16,className:"text-green-600"})}),e.jsx("p",{className:"font-bold text-lg",children:"ðŸŽ‰ Quiz & Room Ready!"})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:"Room Code:"}),e.jsx("code",{className:"bg-gray-100 px-3 py-1 rounded-lg font-mono text-lg font-bold",children:u}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(u),n.success("Room code copied!")},className:"p-1 hover:bg-gray-200 rounded",title:"Copy room code",children:e.jsx(ge,{size:16})})]})})]}),{duration:6e3}),setTimeout(()=>{j(`/host/${u}`)},1e3),!0}catch(r){console.error("Failed to create and host:",r);const d=r.message||r.error||"Failed to create quiz and room";return n.error(d),!1}finally{c(!1)}},U=async(s,r,d,g={})=>{c(!0);try{let u;g.quiz?u=g.quiz:u=await I.generateAIQuiz(s,{numQuestions:r,difficulty:d,category:s});const $={title:u.title||`Quiz: ${s}`,description:u.description||`Quiz about ${s}`,category:u.category||"General Knowledge",difficulty:d||"medium",questions:u.questions||[],aiGenerated:!!u.aiGenerated,aiModel:u.aiModel||"fallback",settings:{randomizeQuestions:!0,showLeaderboard:!0,showExplanations:!0,allowLateJoin:!0,...g.settings},tags:[s.toLowerCase().replace(/\s+/g,"-"),u.fallback?"fallback":"ai-generated",d],visibility:"public"};await P($)}catch(u){console.error("Quiz generation error:",u),n.error(u.message||"Failed to generate quiz")}finally{c(!1)}},L=async(s,r)=>{if(s){c(!0),f(0);try{const d=new FormData;r==="pdf"?d.append("file",s):d.append("audio",s),d.append("numberOfQuestions","10"),d.append("difficulty","medium"),d.append("category","General"),n.loading(`Processing ${r==="pdf"?"PDF":"audio"}...`,{id:"upload"});let g;const u=y=>{const D=Math.round(y.loaded*100/y.total);f(D)};if(r==="pdf"){const y=await I.generateFromPDF(d,u);g=y.quiz||y}else{const y=await I.generateFromAudio(d,u);g=y.quiz||y}n.dismiss("upload");const $=Array.isArray(g)?g:g.questions||[],z=Array.isArray(g)?{title:`${r==="pdf"?"PDF":"Audio"} Quiz`,questions:g,category:"General"}:g;if(!z.questions||z.questions.length===0)throw new Error("No questions were generated. Please try a different file.");n.success(`Generated ${z.questions.length} questions!`);const ae={title:z.title||"Content Quiz",description:`Generated from ${r==="pdf"?"PDF":"audio"}: ${s.name}`,category:z.category||"General",difficulty:z.difficulty||"medium",questions:z.questions.map(y=>{const D=y.options||[];let O=-1;y.correctIndex!==void 0?O=y.correctIndex:y.correctAnswer&&(O=D.findIndex(E=>String(E).toLowerCase().trim()===String(y.correctAnswer).toLowerCase().trim()));const V=O>=0?O:0;return{question:y.question,type:"multiple-choice",options:D.map((E,ie)=>({text:typeof E=="string"?E:E.text,isCorrect:ie===V})),correctAnswer:D[V],explanation:y.explanation||"",timeLimit:30,points:100}})};await P(ae)}catch(d){console.error("File upload error:",d),n.error(d.message||"Failed to process file")}finally{c(!1),f(0),m(null),n.dismiss("upload")}}},H=async()=>{try{const s=await navigator.mediaDevices.getUserMedia({audio:!0});b.current=new MediaRecorder(s),k.current=[],b.current.ondataavailable=r=>{r.data.size>0&&k.current.push(r.data)},b.current.onstop=()=>{const r=new Blob(k.current,{type:"audio/webm"}),d=URL.createObjectURL(r);w({blob:r,url:d}),s.getTracks().forEach(g=>g.stop())},b.current.start(),q(!0),x(0),T.current=setInterval(()=>{x(r=>r+1)},1e3),n.success("Recording started!")}catch(s){console.error("Microphone error:",s),n.error("Could not access microphone.")}},B=()=>{b.current&&S&&(b.current.stop(),q(!1),T.current&&clearInterval(T.current),n.success("Recording stopped!"))},t=async()=>{if(!A)return;const s=new File([A.blob],`recording_${Date.now()}.webm`,{type:"audio/webm"});await L(s,"audio"),w(null),x(0)},a=s=>{const r=Math.floor(s/60),d=s%60;return`${r}:${d.toString().padStart(2,"0")}`};return e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-white py-12 px-4",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("div",{className:"inline-flex items-center space-x-2 bg-gradient-to-r from-purple-100 to-indigo-100 px-6 py-2 rounded-full mb-4 shadow-sm border border-purple-200",children:[e.jsx(ee,{className:"text-purple-600",size:18}),e.jsx("span",{className:"text-purple-800 font-semibold text-sm",children:"Create & Host Live Quizzes"})]}),e.jsxs("h1",{className:"text-4xl md:text-5xl font-extrabold mb-4 text-gray-800 tracking-tight",children:["Create Your ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-indigo-600",children:"Masterpiece"})]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-4 mb-10",children:[{id:"templates",icon:fe,label:"Templates",desc:"Quick Start"},{id:"ai",icon:te,label:"AI Generator",desc:"Auto-create"},{id:"manual",icon:re,label:"Manual",desc:"Start fresh"},{id:"pdf",icon:W,label:"PDF Upload",desc:"From file"},{id:"audio",icon:K,label:"Audio / Voice",desc:"From speech"}].map(s=>e.jsxs("button",{onClick:()=>i(s.id),disabled:v,className:`flex flex-col items-center justify-center p-4 w-32 md:w-40 rounded-2xl transition-all duration-300 ${h===s.id?"bg-white shadow-lg border-2 border-purple-500 scale-105":"bg-white/50 border border-gray-200 hover:bg-white hover:shadow-md"}`,children:[e.jsx(s.icon,{className:`mb-2 ${h===s.id?"text-purple-600":"text-gray-500"}`,size:28}),e.jsx("span",{className:`font-bold ${h===s.id?"text-gray-800":"text-gray-600"}`,children:s.label}),e.jsx("span",{className:"text-xs text-gray-400 mt-1",children:s.desc})]},s.id))}),e.jsxs("div",{className:"bg-white rounded-3xl shadow-xl p-6 md:p-10 border border-gray-100 min-h-[500px]",children:[v&&e.jsxs("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-50 flex flex-col items-center justify-center rounded-3xl",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Creating Magic..."}),e.jsx("p",{className:"text-gray-500",children:C>0?`Uploading: ${C}%`:"Please wait while we process"})]}),h==="templates"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[Ne.map(s=>e.jsxs(M.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{Q(s),n.success(`Selected ${s.title} template!`),i("manual")},className:"bg-white p-6 rounded-2xl border border-gray-200 text-left hover:border-indigo-500 hover:shadow-md transition-all group",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center mb-4 ${s.color}`,children:e.jsx(s.icon,{size:24})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 group-hover:text-indigo-600 transition-colors",children:s.title}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:s.description})]},s.id)),e.jsxs(M.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>i("manual"),className:"bg-gray-50 p-6 rounded-2xl border-2 border-dashed border-gray-300 text-left hover:border-indigo-500 hover:bg-white transition-all group flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gray-200 flex items-center justify-center mb-4 text-gray-500 group-hover:bg-indigo-50 group-hover:text-indigo-600 transition-colors",children:e.jsx(G,{size:24})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Blank Quiz"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Start from scratch"})]})]}),h==="ai"&&e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Generate with AI"}),e.jsx("p",{className:"text-gray-500",children:"Enter a topic and let our AI create the perfect quiz for you."})]}),e.jsx(je,{onGenerate:U,loading:v,setLoading:c})]}),h==="manual"&&e.jsx(ve,{onCreate:P,loading:v,initialData:N?{title:N.title,description:N.description,settings:N.settings}:null}),h==="pdf"&&e.jsxs("div",{className:"max-w-xl mx-auto text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Create from PDF"}),e.jsxs("div",{className:"border-3 border-dashed border-gray-200 rounded-3xl p-10 hover:border-purple-400 hover:bg-purple-50 transition-all cursor-pointer group",onClick:()=>document.getElementById("pdf-input").click(),children:[e.jsx("div",{className:"w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform",children:e.jsx(W,{className:"text-purple-600",size:32})}),e.jsx("h3",{className:"text-xl font-semibold mb-2 text-gray-700",children:"Click to Upload PDF"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Or drag and drop file here"}),e.jsx("button",{className:"px-6 py-3 bg-purple-600 text-white rounded-xl font-bold font-medium group-hover:shadow-lg transition-all",children:"Select Document"}),e.jsx("input",{id:"pdf-input",type:"file",accept:".pdf",className:"hidden",onChange:s=>{s.target.files[0]&&L(s.target.files[0],"pdf")}})]}),e.jsx("p",{className:"mt-6 text-sm text-gray-500",children:"Supported formats: PDF (Text-selectable files work best)"})]}),h==="audio"&&e.jsxs("div",{className:"max-w-xl mx-auto",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6 text-center",children:"Create from Audio"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6 border border-gray-200",children:[e.jsxs("h3",{className:"font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx(W,{size:20,className:"mr-2 text-blue-600"}),"Upload Audio File"]}),e.jsx("input",{type:"file",accept:"audio/*",className:`block w-full text-sm text-gray-500\r
                                        file:mr-4 file:py-2.5 file:px-4\r
                                        file:rounded-full file:border-0\r
                                        file:text-sm file:font-semibold\r
                                        file:bg-blue-50 file:text-blue-700\r
                                        hover:file:bg-blue-100`,onChange:s=>{s.target.files[0]&&L(s.target.files[0],"audio")}}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"MP3, WAV, M4A supported"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"OR"})})]}),e.jsx("div",{className:`border-2 ${S?"border-red-400 bg-red-50":"border-gray-200 bg-white"} rounded-2xl p-8 text-center transition-colors`,children:A?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 text-green-700 rounded-xl border border-green-200 flex items-center justify-center gap-2",children:[e.jsx(_,{size:20}),e.jsx("span",{className:"font-bold",children:"Audio Recorded!"})]}),e.jsx("audio",{src:A.url,controls:!0,className:"w-full"}),e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsx("button",{onClick:()=>w(null),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg font-medium",children:"Discard"}),e.jsx("button",{onClick:t,className:"px-6 py-2 bg-purple-600 text-white rounded-lg font-bold hover:bg-purple-700 shadow-md",children:"Generate Quiz"})]})]}):e.jsx(e.Fragment,{children:S?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-red-500 animate-pulse mx-auto"}),e.jsx("div",{className:"text-3xl font-mono font-bold text-gray-800",children:a(o)}),e.jsx("p",{className:"text-red-500 font-medium",children:"Recording in progress..."}),e.jsx("button",{onClick:B,className:"px-8 py-3 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 transition-colors shadow-lg shadow-red-200",children:"Stop Recording"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto text-red-500",children:e.jsx(K,{size:32})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Record Voice Note"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Speak your questions or topic directly"}),e.jsx("button",{onClick:H,className:"px-8 py-3 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 transition-colors shadow-lg shadow-red-200",children:"Start Recording"})]})})})]})]})]})]})})};export{Te as default};
